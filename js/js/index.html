<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>XIME Leave System - Login</title>
</head>
<body>
  <h2>XIME Leave System</h2>
  <p id="status">Please sign in.</p>
  <button id="btnGoogle">Sign in with Google</button>

  <script type="module">
    import { auth, googleProvider } from "./js/firebase.js";
    import { signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";

    const statusEl = document.getElementById("status");
    const btn = document.getElementById("btnGoogle");

    btn.addEventListener("click", async () => {
      try {
        await signInWithPopup(auth, googleProvider);
      } catch (err) {
        console.error(err);
        statusEl.textContent = "Login failed: " + (err?.message || err);
      }
    });

    onAuthStateChanged(auth, (user) => {
      if (user?.email) {
        statusEl.textContent = "Signed in as " + user.email + " â†’ Redirecting...";
        window.location.href = "./student.html";
      }
    });
  </script>
</body>
</html>
